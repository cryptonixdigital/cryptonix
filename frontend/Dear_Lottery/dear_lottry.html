<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ডিয়ার লটারি - এডিট/ডিলিট功能 সহ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 15px;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 900px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .header {
            margin-bottom: 20px;
        }
        
        h1 {
            color: #b21f1f;
            margin-bottom: 12px;
            font-size: 24px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .description {
            color: #444;
            margin-bottom: 8px;
            line-height: 1.5;
            font-size: 14px;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 8px;
            flex-wrap: wrap;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab {
            padding: 10px 15px;
            background: #e0e0e0;
            border: none;
            border-radius: 6px 6px 0 0;
            margin: 0 3px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            min-width: 100px;
            color: #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tab.active {
            background: linear-gradient(to right, #1a2a6c, #b21f1f);
            color: white;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        
        .tab:hover {
            background: #d0d0d0;
            transform: translateY(-2px);
        }
        
        .tab-content {
            display: none;
            padding: 15px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .game-type-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .game-type-btn {
            padding: 12px 20px;
            background: #e0e0e0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            color: #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .game-type-btn.active {
            background: linear-gradient(to right, #1a2a6c, #b21f1f);
            color: white;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        
        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            border-color: #6a11cb;
            outline: none;
        }
        
        button {
            background: linear-gradient(to right, #1a2a6c, #b21f1f);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 700;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            margin: 8px 3px;
            width: 100%;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .btn-success {
            background: linear-gradient(to right, #1a2a6c, #00b09b);
        }
        
        .btn-danger {
            background: linear-gradient(to right, #dc2430, #7b4397);
        }
        
        .btn-warning {
            background: linear-gradient(to right, #ff9966, #ff5e62);
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.08);
        }
        
        .result h3 {
            color: #1a2a6c;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .lottery-number {
            font-size: 24px;
            font-weight: 800;
            color: #1a2a6c;
            letter-spacing: 3px;
            background: linear-gradient(135deg, #fdbb2d, #b21f1f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            padding: 12px;
            border: 2px dashed #b21f1f;
            border-radius: 8px;
            margin: 15px 0;
            word-break: break-all;
        }
        
        .game-results {
            display: flex;
            flex-direction: column;
            margin: 15px 0;
        }
        
        .game-result {
            margin: 8px 0;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            position: relative;
        }
        
        .game-result h3 {
            color: #1a2a6c;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .edit-btn {
            background: #fdbb2d;
            color: #1a2a6c;
        }
        
        .delete-btn {
            background: #dc3545;
            color: white;
        }
        
        .save-counter {
            background: #fdbb2d;
            color: #1a2a6c;
            padding: 8px 12px;
            border-radius: 15px;
            font-weight: bold;
            margin-top: 12px;
            display: inline-block;
            font-size: 14px;
        }
        
        .footer {
            margin-top: 20px;
            color: #666;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 10px;
        }
        
        @media (min-width: 768px) {
            .container {
                padding: 30px;
            }
            
            h1 {
                font-size: 32px;
                margin-bottom: 15px;
            }
            
            .description {
                font-size: 18px;
                margin-bottom: 10px;
            }
            
            .tab {
                padding: 12px 25px;
                font-size: 16px;
                margin: 0 5px;
                min-width: auto;
            }
            
            .game-results {
                flex-direction: row;
                justify-content: space-between;
                flex-wrap: wrap;
            }
            
            .game-result {
                flex: 1;
                min-width: 220px;
                margin: 10px;
            }
            
            .lottery-number {
                font-size: 32px;
                letter-spacing: 4px;
            }
        }
        
        @media (max-width: 360px) {
            .tab {
                padding: 8px 12px;
                font-size: 12px;
                min-width: 80px;
            }
            
            .game-type-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .lottery-number {
                font-size: 20px;
                letter-spacing: 2px;
            }
            
            button {
                padding: 12px 15px;
                font-size: 14px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ডিয়ার লটারি - এডিট/ডিলিট功能 সহ</h1>
            <p class="description">প্রতিদিন ৬টি গেম - 1CR (৩টি) এবং 5CR (৩টি)</p>
        </div>
        
        <div class="tabs">
            <button class="tab active" data-tab="entry">রেজাল্ট</button>
            <button class="tab" data-tab="prediction">লাকি নাম্বার</button>
            <button class="tab" data-tab="history">ইতিহাস</button>
            <button class="tab" data-tab="manage">ডেটা ম্যানেজ</button>
        </div>
        
        <div class="tab-content active" id="entry">
            <h2>রেজাল্ট এন্ট্রি</h2>
            
            <div class="game-type-selector">
                <button class="game-type-btn active" data-game-type="1cr">1CR গেম</button>
                <button class="game-type-btn" data-game-type="5cr">5CR गेम</button>
            </div>
            
            <div class="input-group">
                <label for="resultDate">তারিখ</label>
                <input type="date" id="resultDate">
            </div>
            
            <div class="input-group">
                <label for="drawTime">সময় নির্বাচন করুন</label>
                <select id="drawTime">
                    <option value="afternoon">দুপুর ১টা</option>
                    <option value="evening">সন্ধ্যা ৬টা</option>
                    <option value="night">রাত ৮টা</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="lotteryNumber">জয়ী নাম্বার</label>
                <input type="text" id="lotteryNumber" placeholder="65G93018">
            </div>
            
            <button class="btn-success" id="saveResult">সেভ করুন</button>
            
            <div class="save-counter">মোট সেভ: <span id="saveCount">0</span></div>
            
            <div class="result">
                <h3 id="selectedDateResult">আজকের রেজাল্ট</h3>
                
                <div class="game-results">
                    <div class="game-result">
                        <h3>1CR - দুপুর ১টা</h3>
                        <div class="lottery-number" id="1crAfternoonResult">---</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" data-game-type="1cr" data-time="afternoon">এডিট</button>
                            <button class="action-btn delete-btn" data-game-type="1cr" data-time="afternoon">ডিলিট</button>
                        </div>
                    </div>
                    <div class="game-result">
                        <h3>1CR - সন্ধ্যা ৬টা</h3>
                        <div class="lottery-number" id="1crEveningResult">---</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" data-game-type="1cr" data-time="evening">এডিট</button>
                            <button class="action-btn delete-btn" data-game-type="1cr" data-time="evening">ডিলিট</button>
                        </div>
                    </div>
                    <div class="game-result">
                        <h3>1CR - রাত ৮টা</h3>
                        <div class="lottery-number" id="1crNightResult">---</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" data-game-type="1cr" data-time="night">এডিট</button>
                            <button class="action-btn delete-btn" data-game-type="1cr" data-time="night">ডিলিট</button>
                        </div>
                    </div>
                </div>
                
                <div class="game-results">
                    <div class="game-result">
                        <h3>5CR - দুপুর ১টা</h3>
                        <div class="lottery-number" id="5crAfternoonResult">---</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" data-game-type="5cr" data-time="afternoon">এডিট</button>
                            <button class="action-btn delete-btn" data-game-type="5cr" data-time="afternoon">ডিলিট</button>
                        </div>
                    </div>
                    <div class="game-result">
                        <h3>5CR - সন্ধ্যা ৬টা</h3>
                        <div class="lottery-number" id="5crEveningResult">---</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" data-game-type="5cr" data-time="evening">এডিট</button>
                            <button class="action-btn delete-btn" data-game-type="5cr" data-time="evening">ডিলিট</button>
                        </div>
                    </div>
                    <div class="game-result">
                        <h3>5CR - রাত ৮টা</h3>
                        <div class="lottery-number" id="5crNightResult">---</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" data-game-type="5cr" data-time="night">এডিট</button>
                            <button class="action-btn delete-btn" data-game-type="5cr" data-time="night">ডিলিট</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="prediction">
            <h2>লাকি নাম্বার</h2>
            
            <div class="game-type-selector">
                <button class="game-type-btn active" data-game-type="1cr">1CR গেম</button>
                <button class="game-type-btn" data-game-type="5cr">5CR गेम</button>
            </div>
            
            <button id="generateLucky">লাকি নাম্বার তৈরি করুন</button>
            
            <div class="result">
                <h3 id="luckyNumberTitle">1CR গেমের লাকি নাম্বার</h3>
                <div class="lottery-number" id="luckyNumber">---</div>
                
                <div class="game-results">
                    <div class="game-result">
                        <h3>দুপুর ১টার জন্য</h3>
                        <div class="lottery-number" id="luckyAfternoon">---</div>
                    </div>
                    <div class="game-result">
                        <h3>সন্ধ্যা ৬টার জন্য</h3>
                        <div class="lottery-number" id="luckyEvening">---</div>
                    </div>
                    <div class="game-result">
                        <h3>রাত ৮টার জন্য</h3>
                        <div class="lottery-number" id="luckyNight">---</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="history">
            <h2>রেজাল্ট ইতিহাস</h2>
            
            <div class="game-type-selector">
                <button class="game-type-btn active" data-game-type="1cr">1CR গেম</button>
                <button class="game-type-btn" data-game-type="5cr">5CR गेम</button>
            </div>
            
            <div class="input-group">
                <label for="historyDate">তারিখ নির্বাচন</label>
                <input type="date" id="historyDate">
            </div>
            
            <button id="loadHistory">ইতিহাস দেখুন</button>
            
            <div class="result">
                <h3 id="historyDateTitle">1CR গেমের ইতিহাস</h3>
                <div id="historyResults"></div>
            </div>
        </div>
        
        <div class="tab-content" id="manage">
            <h2>ডেটা ম্যানেজমেন্ট</h2>
            
            <div class="result">
                <h3>সমস্ত ডেটা ম্যানেজ করুন</h3>
                
                <div class="input-group">
                    <label for="manageDate">তারিখ নির্বাচন করুন</label>
                    <input type="date" id="manageDate">
                </div>
                
                <button id="loadManageData">ডেটা লোড করুন</button>
                
                <div id="manageResults" style="margin-top: 20px;"></div>
                
                <div style="margin-top: 30px;">
                    <h3>ডেটা রিসেট</h3>
                    <p style="color: #b21f1f; margin: 15px 0;">সতর্কতা: এই অপারেশনটি বিপরীতযোগ্য নয়। সমস্ত ডেটা মুছে ফেলা হবে。</p>
                    <button class="btn-danger" id="resetAllData">সমস্ত ডেটা রিসেট করুন</button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>ভাগ্য আপনার সহায় হোক! দয়া করে জুয়াখেলার প্রতি দায়িত্বশীল আচরণ করুন।</p>
        </div>
    </div>

    <!-- কনফার্মেশন মোডাল -->
    <div class="confirmation-modal" id="confirmationModal">
        <div class="modal-content">
            <h3 id="modalTitle">আপনি কি নিশ্চিত?</h3>
            <p id="modalMessage">এই কাজটিUndo করা যাবে না।</p>
            <div class="modal-buttons">
                <button class="btn-danger" id="modalConfirm">হ্যাঁ</button>
                <button id="modalCancel">বাতিল করুন</button>
            </div>
        </div>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    // বর্তমানে নির্বাচিত গেমের ধরন
    let selectedGameType = '1cr';
    let currentAction = { type: '', gameType: '', time: '', callback: null };
    
    // ট্যাব ফাংশনালিটি
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.getAttribute('data-tab');
            
            // সকল ট্যাব এবং কন্টেন্ট থেকে active ক্লাস সরান
            tabs.forEach(t => t.classList.remove('active'));
            tabContents.forEach(tc => tc.classList.remove('active'));
            
            // নির্বাচিত ট্যাব এবং কন্টেন্টে active ক্লাস যোগ করুন
            tab.classList.add('active');
            document.getElementById(tabId).classList.add('active');
            
            // মোবাইল ডিভাইসে ট্যাব क्लিক করলে পেজ স্ক্রল করে উপরে নিয়ে আসে
            if (window.innerWidth < 768) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
    });
    
    // গেম টাইপ সিলেক্টর
    const gameTypeBtns = document.querySelectorAll('.game-type-btn');
    gameTypeBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            gameTypeBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            selectedGameType = btn.getAttribute('data-game-type');
            
            // UI আপডেট করুন
            updateGameTypeUI();
        });
    });
    
    // তারিখ সেট করুন
    const today = new Date();
    document.getElementById('resultDate').valueAsDate = today;
    document.getElementById('historyDate').valueAsDate = today;
    document.getElementById('manageDate').valueAsDate = today;
    
    // ডেটা লোড করুন
    loadAllData();
    
    // রেজাল্ট সেভ করার ইভেন্ট
    document.getElementById('saveResult').addEventListener('click', function() {
        const date = document.getElementById('resultDate').value;
        const time = document.getElementById('drawTime').value;
        const number = document.getElementById('lotteryNumber').value.trim().toUpperCase();
        
        saveResult(date, time, number);
    });
    
    // লাকি নাম্বার জেনারেট করুন
    document.getElementById('generateLucky').addEventListener('click', function() {
        analyzeAndGenerateLuckyNumber();
    });
    
    // ইতিহাস লোড করুন
    document.getElementById('loadHistory').addEventListener('click', function() {
        loadHistory();
    });
    
    // ম্যানেজ ডেটা লোড করুন
    document.getElementById('loadManageData').addEventListener('click', function() {
        loadManageData();
    });
    
    // সমস্ত ডেটা রিসেট করুন
    document.getElementById('resetAllData').addEventListener('click', function() {
        showConfirmationModal(
            'সমস্ত ডেটা রিসেট করুন', 
            'আপনি কি নিশ্চিত যে আপনি সমস্ত ডেটা মুছে ফেলতে চান? এই কাজটিUndo করা যাবে না।',
            resetAllData
        );
    });
    
    // তারিখ পরিবর্তন হলে রেজাল্ট লোড করুন
    document.getElementById('resultDate').addEventListener('change', function() {
        loadDateResults(this.value);
    });
    
    // এডিট বাটন ইভেন্ট
    document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const gameType = this.getAttribute('data-game-type');
            const time = this.getAttribute('data-time');
            editResult(gameType, time);
        });
    });
    
    // ডিলিট বাটন ইভেন্ট
    document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const gameType = this.getAttribute('data-game-type');
            const time = this.getAttribute('data-time');
            
            showConfirmationModal(
                'রেজাল্ট ডিলিট করুন', 
                `আপনি কি ${getTimeName(time)} এর ${gameType.toUpperCase()} রেজাল্ট ডিলিট করতে চান?`,
                function() { deleteResult(gameType, time); }
            );
        });
    });
    
    // মোডাল ইভেন্ট
    document.getElementById('modalConfirm').addEventListener('click', function() {
        if (currentAction.callback) {
            currentAction.callback();
        }
        hideConfirmationModal();
    });
    
    document.getElementById('modalCancel').addEventListener('click', function() {
        hideConfirmationModal();
    });
    
    // কনফার্মেশন মোডাল ফাংশন
    function showConfirmationModal(title, message, callback) {
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalMessage').textContent = message;
        document.getElementById('confirmationModal').style.display = 'flex';
        
        currentAction.callback = callback;
    }
    
    function hideConfirmationModal() {
        document.getElementById('confirmationModal').style.display = 'none';
        currentAction.callback = null;
    }
    
    // গেম টাইপ UI আপডেট ফাংশন
    function updateGameTypeUI() {
        // লাকি নাম্বার টাইটেল আপডেট
        const gameTypeText = selectedGameType === '1cr' ? '1CR' : '5CR';
        document.getElementById('luckyNumberTitle').textContent = `${gameTypeText} গেমের লাকি নাম্বার`;
        
        // ইতিহাস টাইটেল আপডেট
        document.getElementById('historyDateTitle').textContent = `${gameTypeText} গেমের ইতিহাস`;
        
        // তারিখের রেজাল্ট রিলোড
        loadDateResults(document.getElementById('resultDate').value);
    }
    
    // সময়ের নাম ফাংশন
    function getTimeName(time) {
        const timeNames = {
            'afternoon': 'দুপুর ১টা',
            'evening': 'সন্ধ্যা ৬টা', 
            'night': 'রাত ৮টা'
        };
        return timeNames[time] || time;
    }
    
    // নাম্বার ভ্যালিডেশন ফাংশন
    function isValidNumber(number) {
        // 8 অক্ষরের নাম্বার, প্রথম দুটি সংখ্যা, তারপর একটি ইংরেজি অক্ষর, তারপর পাঁচটি সংখ্যা
        const regex = /^[0-9]{2}[A-Z]{1}[0-9]{5}$/;
        return regex.test(number);
    }
    
    // সমস্ত ডেটা বিশ্লেষণ করে লাকি নাম্বার জেনারেটর (হট নাম্বার)
    function analyzeAndGenerateLuckyNumber() {
        const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        const allNumbers = [];
        
        // সমস্ত সেভকৃত নাম্বার সংগ্রহ করুন
        for (const date in results) {
            for (const key in results[date]) {
                if (results[date][key] && results[date][key] !== '---') {
                    allNumbers.push(results[date][key]);
                }
            }
        }
        
        if (allNumbers.length === 0) {
            alert('কোন ডেটা পাওয়া যায়নি। প্রথমে কিছু রেজাল্ট সেভ করুন।');
            return;
        }
        
        // ফ্রিকোয়েন্সি এনালাইসিস
        const digitFrequency = {0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0};
        const letterFrequency = {A:0,B:0,C:0,D:0,E:0,G:0,H:0,J:0,K:0,L:0};
        
        allNumbers.forEach(number => {
            // সংখ্যা অংশ বিশ্লেষণ (পজিশন 0,1,3,4,5,6,7)
            for (let i = 0; i < 8; i++) {
                if (i !== 2) { // 3rd position is letter, skip
                    const char = number[i];
                    if (!isNaN(char)) {
                        digitFrequency[char]++;
                    }
                }
            }
            
            // অক্ষর অংশ বিশ্লেষণ (পজিশন 2)
            const letter = number[2];
            if (letterFrequency.hasOwnProperty(letter)) {
                letterFrequency[letter]++;
            }
        });
        
        // সবচেয়ে বেশি ব্যবহৃত সংখ্যা এবং অক্ষর খুঁজুন (হট নাম্বার)
        const mostUsedDigits = findMostUsed(digitFrequency, 2);
        const mostUsedLetter = findMostUsed(letterFrequency, 1)[0];
        
        // লাকি নাম্বার তৈরি করুন (হট নাম্বার)
        const baseNumber = mostUsedDigits[0] + mostUsedDigits[1] + mostUsedLetter + 
                          getRandomDigits(5, digitFrequency, true);
        
        document.getElementById('luckyNumber').textContent = baseNumber;
        
        // প্রতিটি সময়ের জন্য আলাদা নাম্বার জেনারেট করুন
        document.getElementById('luckyAfternoon').textContent = generateTimeSpecificNumber(baseNumber, 'afternoon');
        document.getElementById('luckyEvening').textContent = generateTimeSpecificNumber(baseNumber, 'evening');
        document.getElementById('luckyNight').textContent = generateTimeSpecificNumber(baseNumber, 'night');
        
        // বিশ্লেষণ রিপোর্ট দেখান
        showAnalysisReport(digitFrequency, letterFrequency, baseNumber);
    }
    
    function findMostUsed(frequencyObj, count) {
        return Object.entries(frequencyObj)
            .sort((a, b) => b[1] - a[1])
            .slice(0, count)
            .map(item => item[0]);
    }
    
    function getRandomDigits(length, frequency, useMostFrequent) {
        let result = '';
        const sortedDigits = Object.entries(frequency)
            .sort((a, b) => useMostFrequent ? b[1] - a[1] : a[1] - b[1])
            .slice(0, 10);
        
        for (let i = 0; i < length; i++) {
            // বেশি ব্যবহৃত সংখ্যাগুলো থেকে র‍্যান্ডমলি নির্বাচন
            const randomIndex = Math.floor(Math.random() * Math.min(5, sortedDigits.length));
            result += sortedDigits[randomIndex][0];
        }
        return result;
    }
    
    function generateTimeSpecificNumber(baseNumber, time) {
        // অনুমোদিত ইংরেজি অক্ষর
        const allowedLetters = ['A', 'B', 'C', 'D', 'E', 'G', 'H', 'J', 'K', 'L'];
        
        // সময়ের উপর ভিত্তি করে নাম্বার পরিবর্তন করুন
        const timeFactors = {
            'afternoon': 3,
            'evening': 7,
            'night': 11
        };
        
        const factor = timeFactors[time];
        
        // প্রথম দুটি সংখ্যা পরিবর্তন
        let firstTwo = parseInt(baseNumber.substring(0, 2));
        firstTwo = (firstTwo + factor) % 100;
        const newFirstTwo = firstTwo.toString().padStart(2, '0');
        
        // মধ্যের অক্ষর পরিবর্তন (শুধুমাত্র অনুমোদিত অক্ষর ব্যবহার)
        const originalChar = baseNumber.substring(2, 3);
        const currentIndex = allowedLetters.indexOf(originalChar);
        const newIndex = (currentIndex + factor) % allowedLetters.length;
        const newChar = allowedLetters[newIndex];
        
        // শেষ পাঁচটি সংখ্যা পরিবর্তন
        let lastFive = parseInt(baseNumber.substring(3));
        lastFive = (lastFive + factor) % 100000;
        const newLastFive = lastFive.toString().padStart(5, '0');
        
        return newFirstTwo + newChar + newLastFive;
    }
    
    function showAnalysisReport(digitFrequency, letterFrequency, luckyNumber) {
        console.log('ডিজিট ফ্রিকোয়েন্সি:', digitFrequency);
        console.log('লেটার ফ্রিকোয়েন্সি:', letterFrequency);
        console.log('জেনারেটেড লাকি নাম্বার:', luckyNumber);
    }
    
    // ইতিহাস লোড ফাংশন
    function loadHistory() {
        const date = document.getElementById('historyDate').value;
        const dateKey = new Date(date).toDateString();
        const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        
        const historyResults = document.getElementById('historyResults');
        
        if (results[dateKey]) {
            let html = '<div class="game-results">';
            
            // নির্বাচিত গেম টাইপের রেজাল্ট দেখান
            ['afternoon', 'evening', 'night'].forEach(time => {
                const resultKey = `${selectedGameType}_${time}`;
                const result = results[dateKey][resultKey] || '---';
                html += `
                    <div class="game-result">
                        <h3>${getTimeName(time)}</h3>
                        <div class="lottery-number">${result}</div>
                    </div>
                `;
            });
            
            html += '</div>';
            historyResults.innerHTML = html;
        } else {
            historyResults.innerHTML = '<p>এই তারিখে কোন রেজাল্ট পাওয়া যায়নি।</p>';
        }
    }
    
    // ফাংশনগুলি
    function loadAllData() {
        // সেভ কাউন্টার লোড করুন
        const saveCount = localStorage.getItem('saveCount') || 0;
        document.getElementById('saveCount').textContent = saveCount;
        
        // আজকের রেজাল্ট লোড করুন
        loadDateResults(new Date().toISOString().slice(0, 10));
    }
    
    function loadDateResults(dateString) {
        const date = new Date(dateString);
        const dateKey = date.toDateString();
        const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        
        // তারিখ শিরোনাম আপডেট করুন
        const dateTitle = date.toLocaleDateString('bn-BD', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
        document.getElementById('selectedDateResult').textContent = `${dateTitle} এর রেজাল্ট`;
        
        // 1CR গেমের রেজাল্ট
        document.getElementById('1crAfternoonResult').textContent = (results[dateKey] && results[dateKey]['1cr_afternoon']) || '---';
        document.getElementById('1crEveningResult').textContent = (results[dateKey] && results[dateKey]['1cr_evening']) || '---';
        document.getElementById('1crNightResult').textContent = (results[dateKey] && results[dateKey]['1cr_night']) || '---';
        
        // 5CR গেমের রেজাল্ট
        document.getElementById('5crAfternoonResult').textContent = (results[dateKey] && results[dateKey]['5cr_afternoon']) || '---';
        document.getElementById('5crEveningResult').textContent = (results[dateKey] && results[dateKey]['5cr_evening']) || '---';
        document.getElementById('5crNightResult').textContent = (results[dateKey] && results[dateKey]['5cr_night']) || '---';
    }
    
    function saveResult(dateString, time, number) {
        if (!number) {
            alert('দয়া করে একটি বৈধ নাম্বার লিখুন');
            return;
        }
        
        if (!isValidNumber(number)) {
            alert('দয়া করে সঠিক ফরম্যাটে নাম্বার লিখুন (যেমন: 65G93018) - প্রথম দুটি সংখ্যা, তারপর একটি ইংরেজি অক্ষর, তারপর পাঁচটি সংখ্যা');
            return;
        }
        
        const date = new Date(dateString);
        const dateKey = date.toDateString();
        let results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        
        if (!results[dateKey]) {
            results[dateKey] = {};
        }
        
        // গেমের কী তৈরি করুন (যেমন: 1cr_afternoon)
        const gameKey = `${selectedGameType}_${time}`;
        results[dateKey][gameKey] = number;
        localStorage.setItem('lotteryResults', JSON.stringify(results));
        
        // সেভ কাউন্টার বাড়ান
        const saveCount = parseInt(localStorage.getItem('saveCount') || 0) + 1;
        localStorage.setItem('saveCount', saveCount);
        document.getElementById('saveCount').textContent = saveCount;
        
        // UI আপডেট করুন
        loadDateResults(dateString);
        
        // ইনপুট ফিল্ড ক্লিয়ার করুন
        document.getElementById('lotteryNumber').value = '';
        
        alert(`${selectedGameType.toUpperCase()} - ${getTimeName(time)} এর রেজাল্ট সেভ হয়েছে!`);
    }
    
    function editResult(gameType, time) {
        const date = document.getElementById('resultDate').value;
        const dateKey = new Date(date).toDateString();
        const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        
        if (results[dateKey] && results[dateKey][`${gameType}_${time}`]) {
            // গেম টাইপ সিলেক্ট করুন
            gameTypeBtns.forEach(btn => {
                if (btn.getAttribute('data-game-type') === gameType) {
                    btn.click();
                }
            });
            
            // সময় সিলেক্ট করুন
            document.getElementById('drawTime').value = time;
            
            // নাম্বার সেট করুন
            document.getElementById('lotteryNumber').value = results[dateKey][`${gameType}_${time}`];
            
            alert(`${gameType.toUpperCase()} - ${getTimeName(time)} এর রেজাল্ট এডিট করার জন্য প্রস্তুত। সেভ করুন বাটনে ক্লিক করে আপডেট করুন।`);
        } else {
            alert('এই সময়ের জন্য কোন রেজাল্ট পাওয়া যায়নি।');
        }
    }
    
    function deleteResult(gameType, time) {
        const date = document.getElementById('resultDate').value;
        const dateKey = new Date(date).toDateString();
        const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        
        if (results[dateKey] && results[dateKey][`${gameType}_${time}`]) {
            delete results[dateKey][`${gameType}_${time}`];
            
            // যদি তারিখে আর কোন ডেটা না থাকে, তাহলে পুরো তারিখ ডিলিট করুন
            if (Object.keys(results[dateKey]).length === 0) {
                delete results[dateKey];
            }
            
            localStorage.setItem('lotteryResults', JSON.stringify(results));
            
            // সেভ কাউন্টার কমান
            const saveCount = Math.max(0, parseInt(localStorage.getItem('saveCount') || 0) - 1);
            localStorage.setItem('saveCount', saveCount);
            document.getElementById('saveCount').textContent = saveCount;
            
            // UI আপডেট করুন
            loadDateResults(date);
            
            alert(`${gameType.toUpperCase()} - ${getTimeName(time)} এর রেজাল্ট ডিলিট হয়েছে!`);
        }
    }
    
    function loadManageData() {
        const date = document.getElementById('manageDate').value;
        const dateKey = new Date(date).toDateString();
        const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
        
        const manageResults = document.getElementById('manageResults');
        
        if (results[dateKey]) {
            let html = '<h3>রেজাল্টসমূহ:</h3><div class="game-results">';
            
            // 1CR গেমের রেজাল্ট
            html += '<div style="width: 100%; margin-bottom: 20px;"><h4>1CR গেম</h4>';
            ['afternoon', 'evening', 'night'].forEach(time => {
                const result = results[dateKey][`1cr_${time}`] || '---';
                html += `
                    <div class="game-result">
                        <h3>${getTimeName(time)}</h3>
                        <div class="lottery-number">${result}</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="manageEditResult('1cr', '${time}', '${date}')">এডিট</button>
                            <button class="action-btn delete-btn" onclick="manageDeleteResult('1cr', '${time}', '${date}')">ডিলিট</button>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            // 5CR গেমের রেজাল্ট
            html += '<div style="width: 100%;"><h4>5CR गेম</h4>';
            ['afternoon', 'evening', 'night'].forEach(time => {
                const result = results[dateKey][`5cr_${time}`] || '---';
                html += `
                    <div class="game-result">
                        <h3>${getTimeName(time)}</h3>
                        <div class="lottery-number">${result}</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="manageEditResult('5cr', '${time}', '${date}')">এডিট</button>
                            <button class="action-btn delete-btn" onclick="manageDeleteResult('5cr', '${time}', '${date}')">ডিলিট</button>
                        </div>
                    </div>
                `;
            });
            html += '</div></div>';
            
            manageResults.innerHTML = html;
        } else {
            manageResults.innerHTML = '<p>এই তারিখে কোন রেজাল্ট পাওয়া যায়নি।</p>';
        }
    }
    
    // গ্লোবাল ফাংশন ম্যানেজমেন্ট এর জন্য
    window.manageEditResult = function(gameType, time, date) {
        document.getElementById('resultDate').value = date;
        document.querySelector(`.tab[data-tab="entry"]`).click();
        
        setTimeout(() => {
            gameTypeBtns.forEach(btn => {
                if (btn.getAttribute('data-game-type') === gameType) {
                    btn.click();
                }
            });
            
            document.getElementById('drawTime').value = time;
            
            const dateKey = new Date(date).toDateString();
            const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
            
            if (results[dateKey] && results[dateKey][`${gameType}_${time}`]) {
                document.getElementById('lotteryNumber').value = results[dateKey][`${gameType}_${time}`];
            }
        }, 100);
    };
    
    window.manageDeleteResult = function(gameType, time, date) {
        showConfirmationModal(
            'রেজাল্ট ডিলিট করুন', 
            `আপনি কি ${date} তারিখের ${getTimeName(time)} এর ${gameType.toUpperCase()} রেজাল্ট ডিলিট করতে চান?`,
            function() { 
                const dateKey = new Date(date).toDateString();
                const results = JSON.parse(localStorage.getItem('lotteryResults') || '{}');
                
                if (results[dateKey] && results[dateKey][`${gameType}_${time}`]) {
                    delete results[dateKey][`${gameType}_${time}`];
                    
                    // যদি তারিখে আর কোন ডেটা না থাকে, তাহলে পুরো তারিখ ডিলিট করুন
                    if (Object.keys(results[dateKey]).length === 0) {
                        delete results[dateKey];
                    }
                    
                    localStorage.setItem('lotteryResults', JSON.stringify(results));
                    
                    // সেভ কাউন্টার কমান
                    const saveCount = Math.max(0, parseInt(localStorage.getItem('saveCount') || 0) - 1);
                    localStorage.setItem('saveCount', saveCount);
                    document.getElementById('saveCount').textContent = saveCount;
                    
                    // UI আপডেট করুন
                    loadManageData();
                    loadDateResults(document.getElementById('resultDate').value);
                    
                    alert(`${gameType.toUpperCase()} - ${getTimeName(time)} এর রেজাল্ট ডিলিট হয়েছে!`);
                }
            }
        );
    };
    
    function resetAllData() {
        localStorage.removeItem('lotteryResults');
        localStorage.removeItem('saveCount');
        
        // UI আপডেট করুন
        document.getElementById('saveCount').textContent = '0';
        loadDateResults(document.getElementById('resultDate').value);
        document.getElementById('manageResults').innerHTML = '';
        
        alert('সমস্ত ডেটা রিসেট করা হয়েছে!');
    }
});
            </script>
            	</body>
            	</html>
            